# Colab Setup Guide\n\n## Quick Start (5 minutes)\n\n### 1. Open the Notebook\n\n1. Go to [Google Colab](https://colab.research.google.com/)\n2. Click **File** → **Open notebook**\n3. Select **GitHub** tab\n4. Search: `yourusername/colab-ai-coder`\n5. Open `notebooks/qwen-assistant.ipynb`\n\n### 2. Run Setup Cells\n\nRun cells in order:\n1. **Environment Check** - Verify GPU/RAM\n2. **Install Dependencies** - Install packages\n3. **Load Model** - Download & load Qwen-2.5-Coder\n4. **Test Inference** - Quick test\n5. **Start API** - Launch FastAPI server\n\n### 3. Copy Public URL\n\nAfter cell 7, you'll get a public URL:\n```\nhttps://xxxx-ngrok-io\n```\n\nUse this to connect from VS Code.\n\n---\n\n## Configuration\n\n### Model Parameters\n\n```python\n# In notebook cell 4:\nTEMPERATURE = 0.2       # Deterministic (0.0-1.0)\nTOP_P = 0.9             # Nucleus sampling\nTOP_K = 40              # Top-k sampling\nREPETITION_PENALTY = 1.05  # Avoid repetition\nMAX_TOKENS = 256        # Max output length\n```\n\n### VRAM Optimization\n\n- **Q4_K_M Quantization**: 5.2GB (from 16GB)\n- **Device Map**: `auto` (GPU/CPU split)\n- **Flash Attention 2**: Enabled (faster)\n- **Offload**: CPU fallback for OOM\n\n### Monitor VRAM\n\nRun cell 10 periodically to check:\n- GPU VRAM usage\n- GPU memory peak\n- System RAM usage\n- Disk space\n\n---\n\n## Troubleshooting\n\n### Out of Memory (OOM)\n\n**Error**: `RuntimeError: CUDA out of memory`\n\n**Solutions**:\n1. Restart runtime: **Runtime** → **Restart runtime**\n2. Reduce batch size / max_tokens\n3. Use smaller model: `Qwen2.5-Coder-1.5B`\n4. Enable aggressive offload\n\n### Slow Inference\n\n**Solutions**:\n1. Increase `num_gpu_layers` (more GPU usage)\n2. Use flash attention 2\n3. Reduce context window (`num_ctx`)\n4. Switch to 1.5B model\n\n### ngrok Not Available\n\n**Error**: `AttributeError: module 'google.colab' has no attribute 'ngrok'`\n\n**Solution**:\n- Install ngrok: `pip install pyngrok`\n- Or use local API: `http://127.0.0.1:8000`\n\n---\n\n## API Usage\n\n### Generate Code\n\n```bash\ncurl -X POST https://xxxx.ngrok-io/api/v1/assistant/generate \\\n  -H \"Content-Type: application/json\" \\\n  -d '{\n    \"prompt\": \"def fibonacci(n):\",\n    \"task\": \"generate\",\n    \"max_tokens\": 150\n  }'\n```\n\n### Refactor Code\n\n```bash\ncurl -X POST https://xxxx.ngrok-io/api/v1/assistant/refactor \\\n  -H \"Content-Type: application/json\" \\\n  -d '{\n    \"prompt\": \"for i in range(len(list)): print(i)\",\n    \"task\": \"refactor\"\n  }'\n```\n\n### Check Model Status\n\n```bash\ncurl https://xxxx.ngrok-io/api/v1/models/current\n```\n\n---\n\n## Keep API Running\n\n**Important**: Keep the Colab tab open and cell running.\n\n- API stops when notebook disconnects\n- Use **Edit** → **Notebook settings** → **Idle timeout** to increase limit\n- Or upgrade to Colab Pro for longer sessions\n\n---\n\n## Next Steps\n\n1. ✅ Install [Colab AI Coder Extension](../vscode-extension/)\n2. ✅ Configure API URL in VS Code\n3. ✅ Start using assistant features\n4. ✅ Explore prompt templates\n\nSee [API Documentation](./api.md) for more details.\n